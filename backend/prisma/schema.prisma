generator client {
  provider = "prisma-client"
  output   = "../src/generated/prisma"
}

datasource db {
  provider = "postgresql"
}

model User {
  id               String  @id @default(cuid())
  name             String?
  bio              String?
  email            String  @unique
  password         String?
  avater           String?
  avater_public_id String?

  createdAt DateTime @default(now())

  sentMessage    Message[] @relation("SentMessage")
  receiveMessage Message[] @relation("ReceiveMessage")

  sentConversations     Conversation[] @relation("SenderConversations")
  receivedConversations Conversation[] @relation("ReceiverConversations")
}

model Message {
  id         String   @id @default(cuid())
  senderId   String
  receiverId String
  text       String?
  image      String?
  isSeen     Boolean  @default(false)
  createdAt  DateTime @default(now())

  conversation   Conversation? @relation(fields: [conversationId], references: [id])
  conversationId String?

  sender   User @relation("SentMessage", fields: [senderId], references: [id])
  receiver User @relation("ReceiveMessage", fields: [receiverId], references: [id])
}

model Conversation {
  id         String @id @default(cuid())
  senderId   String
  receiverId String

  sender   User @relation("SenderConversations", fields: [senderId], references: [id])
  receiver User @relation("ReceiverConversations", fields: [receiverId], references: [id])

  messages Message[]
}
